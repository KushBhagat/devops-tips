# Know each other securely with HashiCorp Consul

## Installation

```bash
curl https://releases.hashicorp.com/consul/1.3.0/consul_1.3.0_linux_amd64.zip \
    -o consul_1.3.0_linux_amd64.zip
sudo unzip consul*.zip -d /usr/bin/
rm consul*.zip
consul
```

See [../tenant/consul.md](../tenant/consul.md)

https://www.consul.io/docs/guides/forwarding.html

/etc/resolv.conf
```bash
; generated by /usr/sbin/dhclient-script
search openstacklocal novalocal
search novalocal.node.dc1.consul node.dc1.consul
nameserver 127.0.0.1    # might be first/alone or it fails
nameserver 10.176.228.1
nameserver 10.176.228.2
```

```bash
sudo iptables -t nat -A PREROUTING -p udp -m udp --dport 53 -j REDIRECT --to-ports 8600
sudo iptables -t nat -A PREROUTING -p tcp -m tcp --dport 53 -j REDIRECT --to-ports 8600
sudo iptables -t nat -A OUTPUT -d localhost -p udp -m udp --dport 53 -j REDIRECT --to-ports 8600
sudo iptables -t nat -A OUTPUT -d localhost -p tcp -m tcp --dport 53 -j REDIRECT --to-ports 8600
```

```bash
ssh <remoteserver>
```

https://www.mauras.ch/securing-consul.html

```dos
"C:\Program Files\Hashicorp\Consul\consul.exe" agent -config-file C:\ProgramData\Hashicorp\Consul\config\consul-server.json
```
